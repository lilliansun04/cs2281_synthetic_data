/n/holylabs/LABS/hlakkaraju_lab/Users/lilliansun/cs2281_synthetic_data /n/holylabs/LABS/hlakkaraju_lab/Users/lilliansun/cs2281_synthetic_data
/n/holylabs/LABS/hlakkaraju_lab/Users/lilliansun/cs2281_synthetic_data /n/holylabs/LABS/hlakkaraju_lab/Users/lilliansun/cs2281_synthetic_data /n/holylabs/LABS/hlakkaraju_lab/Users/lilliansun/cs2281_synthetic_data
Running finetuning_summarization_no_eval_human.py
Saving results to results/summarization/t5-large_1_no_eval_human_seed_2
Number of GPUs available: 1
GPU 0: NVIDIA H100 80GB HBM3
Model name: google/flan-t5-large
Output directory: results/summarization/
Scratch directory: /n/netscratch/hlakkaraju_lab/Everyone/lilliansun/synthetic_data/
Unique save name: t5-large_1_no_eval_human_seed_2
Dataset proportion: 1.0
Summarization train filepath: synthetic/summary_train.csv
Summarization val filepath: synthetic/summary_val.csv
Summarization test filepath: synthetic/summary_test.csv
Batch size: 8
Evaluation steps: 40
Random seed: 2
Random test: 0.9560342718892494
Numpy test: 0.43599490214200376
Torch test: 0.6146950721740723
Size of input_ids tensor: torch.Size([3000]), dtype: torch.int64
Actual sequence length: 542
Size of input_ids tensor: torch.Size([2736]), dtype: torch.int64
Actual sequence length: 293
Size of input_ids tensor: torch.Size([3000]), dtype: torch.int64
Actual sequence length: 965
{'loss': 15.6966, 'grad_norm': 21.878007888793945, 'learning_rate': 4.769850402761795e-05, 'epoch': 0.05}
{'loss': 1.7914, 'grad_norm': 0.8435198068618774, 'learning_rate': 4.539700805523591e-05, 'epoch': 0.09}
{'loss': 0.4466, 'grad_norm': 0.3063594102859497, 'learning_rate': 4.3095512082853856e-05, 'epoch': 0.14}
{'loss': 0.4181, 'grad_norm': 0.2327871471643448, 'learning_rate': 4.079401611047181e-05, 'epoch': 0.18}
{'loss': 0.4131, 'grad_norm': 0.23315565288066864, 'learning_rate': 3.849252013808976e-05, 'epoch': 0.23}
{'loss': 0.4149, 'grad_norm': 0.2176075428724289, 'learning_rate': 3.619102416570771e-05, 'epoch': 0.28}
{'loss': 0.4102, 'grad_norm': 0.22231918573379517, 'learning_rate': 3.3889528193325666e-05, 'epoch': 0.32}
{'loss': 0.4057, 'grad_norm': 0.21173273026943207, 'learning_rate': 3.1588032220943615e-05, 'epoch': 0.37}
{'loss': 0.4068, 'grad_norm': 0.2132241427898407, 'learning_rate': 2.9286536248561568e-05, 'epoch': 0.41}
{'loss': 0.4025, 'grad_norm': 0.22374556958675385, 'learning_rate': 2.698504027617952e-05, 'epoch': 0.46}
{'loss': 0.4109, 'grad_norm': 0.23896324634552002, 'learning_rate': 2.468354430379747e-05, 'epoch': 0.51}
{'loss': 0.4065, 'grad_norm': 0.20772694051265717, 'learning_rate': 2.238204833141542e-05, 'epoch': 0.55}
{'loss': 0.4051, 'grad_norm': 0.20817171037197113, 'learning_rate': 2.008055235903337e-05, 'epoch': 0.6}
{'loss': 0.4059, 'grad_norm': 0.21591809391975403, 'learning_rate': 1.7779056386651323e-05, 'epoch': 0.64}
{'loss': 0.4048, 'grad_norm': 0.1958877444267273, 'learning_rate': 1.5477560414269276e-05, 'epoch': 0.69}
{'loss': 0.4082, 'grad_norm': 0.2402050942182541, 'learning_rate': 1.3176064441887228e-05, 'epoch': 0.74}
{'loss': 0.4081, 'grad_norm': 0.20224210619926453, 'learning_rate': 1.0874568469505179e-05, 'epoch': 0.78}
{'loss': 0.4028, 'grad_norm': 0.24570931494235992, 'learning_rate': 8.57307249712313e-06, 'epoch': 0.83}
{'loss': 0.4018, 'grad_norm': 0.20920419692993164, 'learning_rate': 6.271576524741082e-06, 'epoch': 0.87}
{'loss': 0.4045, 'grad_norm': 0.21210595965385437, 'learning_rate': 3.970080552359034e-06, 'epoch': 0.92}
{'loss': 0.4086, 'grad_norm': 0.2287706732749939, 'learning_rate': 1.668584579976985e-06, 'epoch': 0.97}
{'train_runtime': 17959.8169, 'train_samples_per_second': 1.549, 'train_steps_per_second': 0.048, 'train_loss': 1.1767500371461084, 'epoch': 1.0}
DONE
