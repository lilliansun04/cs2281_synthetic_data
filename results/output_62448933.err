/n/home11/lilliansun/.conda/envs/jupyter_py3.11/lib/python3.11/site-packages/accelerate/accelerator.py:436: FutureWarning: Passing the following arguments to `Accelerator` is deprecated and will be removed in version 1.0 of Accelerate: dict_keys(['dispatch_batches', 'split_batches', 'even_batches', 'use_seedable_sampler']). Please pass an `accelerate.DataLoaderConfiguration` instead: 
dataloader_config = DataLoaderConfiguration(dispatch_batches=None, split_batches=False, even_batches=True, use_seedable_sampler=True)
  warnings.warn(
Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
/n/home11/lilliansun/cs2281_synthetic_data/finetuning_summarization_no_eval.py:95: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  [torch.tensor(ids).clone().detach() for ids in batch["input_ids"]],
/n/home11/lilliansun/cs2281_synthetic_data/finetuning_summarization_no_eval.py:100: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  [torch.tensor(ids).clone().detach() for ids in batch["attention_mask"]],
/n/home11/lilliansun/cs2281_synthetic_data/finetuning_summarization_no_eval.py:105: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  [torch.tensor(ids).clone().detach() for ids in batch["labels"]],
  0%|          | 0/435 [00:00<?, ?it/s]  0%|          | 2/435 [00:00<01:37,  4.45it/s]  1%|          | 4/435 [00:00<01:39,  4.35it/s]  1%|          | 5/435 [00:01<02:06,  3.41it/s]  1%|▏         | 6/435 [00:01<02:24,  2.97it/s]  2%|▏         | 7/435 [00:02<02:37,  2.71it/s]  2%|▏         | 8/435 [00:02<02:46,  2.56it/s]  2%|▏         | 9/435 [00:03<02:52,  2.46it/s]  2%|▏         | 10/435 [00:03<02:57,  2.40it/s]  3%|▎         | 11/435 [00:04<02:59,  2.36it/s]  3%|▎         | 12/435 [00:04<03:01,  2.33it/s]  3%|▎         | 13/435 [00:04<03:02,  2.31it/s]  3%|▎         | 14/435 [00:05<03:03,  2.29it/s]  3%|▎         | 15/435 [00:05<03:04,  2.28it/s]  4%|▎         | 16/435 [00:06<03:04,  2.28it/s]  4%|▍         | 17/435 [00:06<03:03,  2.27it/s]  4%|▍         | 18/435 [00:07<03:03,  2.27it/s]  4%|▍         | 19/435 [00:07<03:03,  2.27it/s]  5%|▍         | 20/435 [00:07<03:02,  2.27it/s]  5%|▍         | 21/435 [00:08<03:02,  2.27it/s]  5%|▌         | 22/435 [00:08<03:02,  2.26it/s]  5%|▌         | 23/435 [00:09<03:02,  2.26it/s]  6%|▌         | 24/435 [00:09<03:01,  2.26it/s]  6%|▌         | 25/435 [00:10<03:01,  2.26it/s]  6%|▌         | 26/435 [00:10<03:00,  2.26it/s]  6%|▌         | 27/435 [00:11<03:00,  2.26it/s]  6%|▋         | 28/435 [00:11<02:59,  2.26it/s]  7%|▋         | 29/435 [00:11<02:59,  2.26it/s]  7%|▋         | 30/435 [00:12<02:58,  2.26it/s]  7%|▋         | 31/435 [00:12<02:58,  2.26it/s]  7%|▋         | 32/435 [00:13<02:58,  2.26it/s]  8%|▊         | 33/435 [00:13<02:57,  2.26it/s]  8%|▊         | 34/435 [00:14<02:57,  2.26it/s]  8%|▊         | 35/435 [00:14<02:56,  2.26it/s]  8%|▊         | 36/435 [00:15<02:56,  2.26it/s]  9%|▊         | 37/435 [00:15<02:55,  2.26it/s]  9%|▊         | 38/435 [00:15<02:55,  2.26it/s]  9%|▉         | 39/435 [00:16<02:55,  2.26it/s]  9%|▉         | 40/435 [00:16<02:54,  2.26it/s]  9%|▉         | 41/435 [00:17<02:54,  2.26it/s] 10%|▉         | 42/435 [00:17<02:53,  2.26it/s] 10%|▉         | 43/435 [00:18<02:53,  2.26it/s] 10%|█         | 44/435 [00:18<02:52,  2.26it/s] 10%|█         | 45/435 [00:19<02:52,  2.26it/s] 11%|█         | 46/435 [00:19<02:51,  2.26it/s] 11%|█         | 47/435 [00:19<02:51,  2.26it/s] 11%|█         | 48/435 [00:20<02:51,  2.26it/s] 11%|█▏        | 49/435 [00:20<02:50,  2.26it/s] 11%|█▏        | 50/435 [00:21<02:50,  2.26it/s] 12%|█▏        | 51/435 [00:21<02:49,  2.26it/s] 12%|█▏        | 52/435 [00:22<02:49,  2.26it/s] 12%|█▏        | 53/435 [00:22<02:48,  2.26it/s] 12%|█▏        | 54/435 [00:23<02:48,  2.26it/s] 13%|█▎        | 55/435 [00:23<02:47,  2.26it/s] 13%|█▎        | 56/435 [00:23<02:47,  2.26it/s] 13%|█▎        | 57/435 [00:24<02:46,  2.26it/s] 13%|█▎        | 58/435 [00:24<02:46,  2.26it/s] 14%|█▎        | 59/435 [00:25<02:46,  2.26it/s] 14%|█▍        | 60/435 [00:25<02:45,  2.26it/s] 14%|█▍        | 61/435 [00:26<02:45,  2.26it/s] 14%|█▍        | 62/435 [00:26<02:44,  2.26it/s] 14%|█▍        | 63/435 [00:26<02:44,  2.26it/s] 15%|█▍        | 64/435 [00:27<02:44,  2.26it/s] 15%|█▍        | 65/435 [00:27<02:43,  2.26it/s] 15%|█▌        | 66/435 [00:28<02:42,  2.26it/s] 15%|█▌        | 67/435 [00:28<02:42,  2.26it/s] 16%|█▌        | 68/435 [00:29<02:42,  2.26it/s] 16%|█▌        | 69/435 [00:29<02:41,  2.26it/s] 16%|█▌        | 70/435 [00:30<02:41,  2.26it/s] 16%|█▋        | 71/435 [00:30<02:40,  2.26it/s] 17%|█▋        | 72/435 [00:30<02:40,  2.26it/s] 17%|█▋        | 73/435 [00:31<02:39,  2.26it/s] 17%|█▋        | 74/435 [00:31<02:39,  2.27it/s] 17%|█▋        | 75/435 [00:32<02:38,  2.26it/s] 17%|█▋        | 76/435 [00:32<02:38,  2.26it/s] 18%|█▊        | 77/435 [00:33<02:38,  2.26it/s] 18%|█▊        | 78/435 [00:33<02:37,  2.26it/s] 18%|█▊        | 79/435 [00:34<02:37,  2.26it/s] 18%|█▊        | 80/435 [00:34<02:36,  2.26it/s] 19%|█▊        | 81/435 [00:34<02:36,  2.26it/s] 19%|█▉        | 82/435 [00:35<02:35,  2.26it/s] 19%|█▉        | 83/435 [00:35<02:35,  2.26it/s] 19%|█▉        | 84/435 [00:36<02:35,  2.26it/s] 20%|█▉        | 85/435 [00:36<02:34,  2.26it/s] 20%|█▉        | 86/435 [00:37<02:34,  2.26it/s] 20%|██        | 87/435 [00:37<02:33,  2.26it/s] 20%|██        | 88/435 [00:38<02:33,  2.26it/s] 20%|██        | 89/435 [00:38<02:32,  2.26it/s] 21%|██        | 90/435 [00:38<02:32,  2.26it/s] 21%|██        | 91/435 [00:39<02:31,  2.26it/s] 21%|██        | 92/435 [00:39<02:31,  2.26it/s] 21%|██▏       | 93/435 [00:40<02:31,  2.26it/s] 22%|██▏       | 94/435 [00:40<02:30,  2.26it/s] 22%|██▏       | 95/435 [00:41<02:30,  2.26it/s] 22%|██▏       | 96/435 [00:41<02:29,  2.26it/s] 22%|██▏       | 97/435 [00:42<02:29,  2.26it/s] 23%|██▎       | 98/435 [00:42<02:28,  2.27it/s] 23%|██▎       | 99/435 [00:42<02:28,  2.26it/s] 23%|██▎       | 100/435 [00:43<02:27,  2.26it/s] 23%|██▎       | 101/435 [00:43<02:27,  2.26it/s] 23%|██▎       | 102/435 [00:44<02:27,  2.26it/s] 24%|██▎       | 103/435 [00:44<02:26,  2.26it/s] 24%|██▍       | 104/435 [00:45<02:26,  2.26it/s] 24%|██▍       | 105/435 [00:45<02:25,  2.26it/s] 24%|██▍       | 106/435 [00:45<02:25,  2.26it/s] 25%|██▍       | 107/435 [00:46<02:25,  2.26it/s] 25%|██▍       | 108/435 [00:46<02:24,  2.26it/s] 25%|██▌       | 109/435 [00:47<02:24,  2.26it/s] 25%|██▌       | 110/435 [00:47<02:23,  2.26it/s] 26%|██▌       | 111/435 [00:48<02:23,  2.26it/s] 26%|██▌       | 112/435 [00:48<02:22,  2.26it/s] 26%|██▌       | 113/435 [00:49<02:22,  2.26it/s] 26%|██▌       | 114/435 [00:49<02:21,  2.26it/s] 26%|██▋       | 115/435 [00:49<02:21,  2.26it/s] 27%|██▋       | 116/435 [00:50<02:20,  2.26it/s] 27%|██▋       | 117/435 [00:50<02:20,  2.26it/s] 27%|██▋       | 118/435 [00:51<02:20,  2.26it/s] 27%|██▋       | 119/435 [00:51<02:19,  2.26it/s] 28%|██▊       | 120/435 [00:52<02:19,  2.26it/s] 28%|██▊       | 121/435 [00:52<02:18,  2.26it/s] 28%|██▊       | 122/435 [00:53<02:18,  2.26it/s] 28%|██▊       | 123/435 [00:53<02:17,  2.26it/s] 29%|██▊       | 124/435 [00:53<02:17,  2.26it/s] 29%|██▊       | 125/435 [00:54<02:16,  2.26it/s] 29%|██▉       | 126/435 [00:54<02:16,  2.26it/s] 29%|██▉       | 127/435 [00:55<02:16,  2.26it/s] 29%|██▉       | 128/435 [00:55<02:15,  2.26it/s] 30%|██▉       | 129/435 [00:56<02:15,  2.26it/s] 30%|██▉       | 130/435 [00:56<02:14,  2.26it/s] 30%|███       | 131/435 [00:57<02:14,  2.26it/s] 30%|███       | 132/435 [00:57<02:13,  2.26it/s] 31%|███       | 133/435 [00:57<02:13,  2.26it/s] 31%|███       | 134/435 [00:58<02:13,  2.26it/s] 31%|███       | 135/435 [00:58<02:12,  2.26it/s] 31%|███▏      | 136/435 [00:59<02:12,  2.26it/s] 31%|███▏      | 137/435 [00:59<02:11,  2.26it/s] 32%|███▏      | 138/435 [01:00<02:11,  2.26it/s] 32%|███▏      | 139/435 [01:00<02:10,  2.26it/s] 32%|███▏      | 140/435 [01:01<02:10,  2.26it/s] 32%|███▏      | 141/435 [01:01<02:09,  2.26it/s] 33%|███▎      | 142/435 [01:01<02:09,  2.26it/s] 33%|███▎      | 143/435 [01:02<02:09,  2.26it/s] 33%|███▎      | 144/435 [01:02<02:08,  2.26it/s] 33%|███▎      | 145/435 [01:03<02:08,  2.26it/s] 34%|███▎      | 146/435 [01:03<02:07,  2.26it/s] 34%|███▍      | 147/435 [01:04<02:07,  2.26it/s] 34%|███▍      | 148/435 [01:04<02:06,  2.26it/s] 34%|███▍      | 149/435 [01:04<02:06,  2.26it/s] 34%|███▍      | 150/435 [01:05<02:05,  2.26it/s] 35%|███▍      | 151/435 [01:05<02:05,  2.26it/s] 35%|███▍      | 152/435 [01:06<02:05,  2.26it/s] 35%|███▌      | 153/435 [01:06<02:04,  2.26it/s] 35%|███▌      | 154/435 [01:07<02:04,  2.26it/s] 36%|███▌      | 155/435 [01:07<02:03,  2.26it/s] 36%|███▌      | 156/435 [01:08<02:03,  2.26it/s] 36%|███▌      | 157/435 [01:08<02:02,  2.26it/s] 36%|███▋      | 158/435 [01:08<02:02,  2.26it/s] 37%|███▋      | 159/435 [01:09<02:01,  2.26it/s] 37%|███▋      | 160/435 [01:09<02:01,  2.26it/s] 37%|███▋      | 161/435 [01:10<02:00,  2.26it/s] 37%|███▋      | 162/435 [01:10<02:00,  2.26it/s] 37%|███▋      | 163/435 [01:11<02:00,  2.26it/s] 38%|███▊      | 164/435 [01:11<01:59,  2.26it/s] 38%|███▊      | 165/435 [01:12<01:59,  2.26it/s] 38%|███▊      | 166/435 [01:12<01:58,  2.26it/s] 38%|███▊      | 167/435 [01:12<01:58,  2.26it/s] 39%|███▊      | 168/435 [01:13<01:58,  2.26it/s] 39%|███▉      | 169/435 [01:13<01:57,  2.26it/s] 39%|███▉      | 170/435 [01:14<01:57,  2.26it/s] 39%|███▉      | 171/435 [01:14<01:56,  2.26it/s] 40%|███▉      | 172/435 [01:15<01:56,  2.26it/s] 40%|███▉      | 173/435 [01:15<01:55,  2.26it/s] 40%|████      | 174/435 [01:16<01:55,  2.26it/s] 40%|████      | 175/435 [01:16<01:54,  2.26it/s] 40%|████      | 176/435 [01:16<01:54,  2.26it/s] 41%|████      | 177/435 [01:17<01:53,  2.26it/s] 41%|████      | 178/435 [01:17<01:53,  2.26it/s] 41%|████      | 179/435 [01:18<01:53,  2.26it/s] 41%|████▏     | 180/435 [01:18<01:52,  2.26it/s] 42%|████▏     | 181/435 [01:19<01:52,  2.26it/s] 42%|████▏     | 182/435 [01:19<01:51,  2.26it/s] 42%|████▏     | 183/435 [01:20<01:51,  2.26it/s] 42%|████▏     | 184/435 [01:20<01:50,  2.26it/s] 43%|████▎     | 185/435 [01:20<01:50,  2.26it/s] 43%|████▎     | 186/435 [01:21<01:49,  2.26it/s] 43%|████▎     | 187/435 [01:21<01:49,  2.26it/s] 43%|████▎     | 188/435 [01:22<01:49,  2.26it/s] 43%|████▎     | 189/435 [01:22<01:48,  2.26it/s] 44%|████▎     | 190/435 [01:23<01:48,  2.26it/s] 44%|████▍     | 191/435 [01:23<01:47,  2.26it/s] 44%|████▍     | 192/435 [01:23<01:47,  2.26it/s] 44%|████▍     | 193/435 [01:24<01:46,  2.26it/s] 45%|████▍     | 194/435 [01:24<01:46,  2.26it/s] 45%|████▍     | 195/435 [01:25<01:46,  2.26it/s] 45%|████▌     | 196/435 [01:25<01:45,  2.26it/s] 45%|████▌     | 197/435 [01:26<01:45,  2.26it/s] 46%|████▌     | 198/435 [01:26<01:44,  2.26it/s] 46%|████▌     | 199/435 [01:27<01:44,  2.26it/s] 46%|████▌     | 200/435 [01:27<01:43,  2.26it/s] 46%|████▌     | 201/435 [01:27<01:43,  2.26it/s] 46%|████▋     | 202/435 [01:28<01:42,  2.26it/s] 47%|████▋     | 203/435 [01:28<01:42,  2.26it/s] 47%|████▋     | 204/435 [01:29<01:42,  2.26it/s] 47%|████▋     | 205/435 [01:29<01:41,  2.26it/s] 47%|████▋     | 206/435 [01:30<01:41,  2.26it/s] 48%|████▊     | 207/435 [01:30<01:40,  2.26it/s] 48%|████▊     | 208/435 [01:31<01:40,  2.26it/s] 48%|████▊     | 209/435 [01:31<01:39,  2.26it/s] 48%|████▊     | 210/435 [01:31<01:39,  2.26it/s] 49%|████▊     | 211/435 [01:32<01:38,  2.26it/s] 49%|████▊     | 212/435 [01:32<01:38,  2.26it/s] 49%|████▉     | 213/435 [01:33<01:38,  2.26it/s] 49%|████▉     | 214/435 [01:33<01:37,  2.26it/s] 49%|████▉     | 215/435 [01:34<01:37,  2.26it/s] 50%|████▉     | 216/435 [01:34<01:36,  2.26it/s] 50%|████▉     | 217/435 [01:35<01:36,  2.26it/s] 50%|█████     | 218/435 [01:35<01:35,  2.26it/s] 50%|█████     | 219/435 [01:35<01:35,  2.26it/s] 51%|█████     | 220/435 [01:36<01:34,  2.26it/s] 51%|█████     | 221/435 [01:36<01:34,  2.26it/s] 51%|█████     | 222/435 [01:37<01:34,  2.26it/s] 51%|█████▏    | 223/435 [01:37<01:33,  2.26it/s] 51%|█████▏    | 224/435 [01:38<01:33,  2.26it/s] 52%|█████▏    | 225/435 [01:38<01:32,  2.26it/s] 52%|█████▏    | 226/435 [01:39<01:32,  2.26it/s] 52%|█████▏    | 227/435 [01:39<01:31,  2.26it/s] 52%|█████▏    | 228/435 [01:39<01:31,  2.26it/s] 53%|█████▎    | 229/435 [01:40<01:30,  2.26it/s] 53%|█████▎    | 230/435 [01:40<01:30,  2.26it/s] 53%|█████▎    | 231/435 [01:41<01:30,  2.26it/s] 53%|█████▎    | 232/435 [01:41<01:29,  2.26it/s] 54%|█████▎    | 233/435 [01:42<01:29,  2.26it/s] 54%|█████▍    | 234/435 [01:42<01:28,  2.26it/s] 54%|█████▍    | 235/435 [01:42<01:28,  2.26it/s] 54%|█████▍    | 236/435 [01:43<01:27,  2.26it/s] 54%|█████▍    | 237/435 [01:43<01:27,  2.26it/s] 55%|█████▍    | 238/435 [01:44<01:26,  2.26it/s] 55%|█████▍    | 239/435 [01:44<01:26,  2.27it/s] 55%|█████▌    | 240/435 [01:45<01:26,  2.26it/s] 55%|█████▌    | 241/435 [01:45<01:25,  2.26it/s] 56%|█████▌    | 242/435 [01:46<01:25,  2.27it/s] 56%|█████▌    | 243/435 [01:46<01:24,  2.26it/s] 56%|█████▌    | 244/435 [01:46<01:24,  2.26it/s] 56%|█████▋    | 245/435 [01:47<01:23,  2.27it/s] 57%|█████▋    | 246/435 [01:47<01:23,  2.27it/s] 57%|█████▋    | 247/435 [01:48<01:23,  2.26it/s] 57%|█████▋    | 248/435 [01:48<01:22,  2.26it/s] 57%|█████▋    | 249/435 [01:49<01:22,  2.26it/s] 57%|█████▋    | 250/435 [01:49<01:21,  2.26it/s] 58%|█████▊    | 251/435 [01:50<01:21,  2.26it/s] 58%|█████▊    | 252/435 [01:50<01:20,  2.26it/s] 58%|█████▊    | 253/435 [01:50<01:20,  2.26it/s] 58%|█████▊    | 254/435 [01:51<01:19,  2.26it/s] 59%|█████▊    | 255/435 [01:51<01:19,  2.26it/s] 59%|█████▉    | 256/435 [01:52<01:19,  2.26it/s] 59%|█████▉    | 257/435 [01:52<01:18,  2.26it/s] 59%|█████▉    | 258/435 [01:53<01:18,  2.26it/s] 60%|█████▉    | 259/435 [01:53<01:17,  2.26it/s] 60%|█████▉    | 260/435 [01:54<01:17,  2.26it/s] 60%|██████    | 261/435 [01:54<01:16,  2.26it/s] 60%|██████    | 262/435 [01:54<01:16,  2.26it/s] 60%|██████    | 263/435 [01:55<01:15,  2.26it/s] 61%|██████    | 264/435 [01:55<01:15,  2.26it/s] 61%|██████    | 265/435 [01:56<01:15,  2.26it/s] 61%|██████    | 266/435 [01:56<01:14,  2.26it/s] 61%|██████▏   | 267/435 [01:57<01:14,  2.26it/s] 62%|██████▏   | 268/435 [01:57<01:13,  2.26it/s] 62%|██████▏   | 269/435 [01:58<01:13,  2.26it/s] 62%|██████▏   | 270/435 [01:58<01:12,  2.26it/s] 62%|██████▏   | 271/435 [01:58<01:12,  2.26it/s] 63%|██████▎   | 272/435 [01:59<01:11,  2.26it/s] 63%|██████▎   | 273/435 [01:59<01:11,  2.26it/s] 63%|██████▎   | 274/435 [02:00<01:11,  2.26it/s] 63%|██████▎   | 275/435 [02:00<01:10,  2.26it/s] 63%|██████▎   | 276/435 [02:01<01:10,  2.26it/s] 64%|██████▎   | 277/435 [02:01<01:09,  2.26it/s] 64%|██████▍   | 278/435 [02:01<01:09,  2.26it/s] 64%|██████▍   | 279/435 [02:02<01:08,  2.26it/s] 64%|██████▍   | 280/435 [02:02<01:08,  2.26it/s] 65%|██████▍   | 281/435 [02:03<01:08,  2.26it/s] 65%|██████▍   | 282/435 [02:03<01:07,  2.26it/s] 65%|██████▌   | 283/435 [02:04<01:07,  2.26it/s] 65%|██████▌   | 284/435 [02:04<01:06,  2.26it/s] 66%|██████▌   | 285/435 [02:05<01:06,  2.26it/s] 66%|██████▌   | 286/435 [02:05<01:05,  2.26it/s] 66%|██████▌   | 287/435 [02:05<01:05,  2.26it/s] 66%|██████▌   | 288/435 [02:06<01:05,  2.26it/s] 66%|██████▋   | 289/435 [02:06<01:04,  2.26it/s] 67%|██████▋   | 290/435 [02:07<01:04,  2.26it/s] 67%|██████▋   | 291/435 [02:07<01:03,  2.26it/s] 67%|██████▋   | 292/435 [02:08<01:03,  2.26it/s] 67%|██████▋   | 293/435 [02:08<01:02,  2.26it/s] 68%|██████▊   | 294/435 [02:09<01:02,  2.26it/s] 68%|██████▊   | 295/435 [02:09<01:01,  2.26it/s] 68%|██████▊   | 296/435 [02:09<01:01,  2.26it/s] 68%|██████▊   | 297/435 [02:10<01:00,  2.26it/s] 69%|██████▊   | 298/435 [02:10<01:00,  2.26it/s] 69%|██████▊   | 299/435 [02:11<01:00,  2.26it/s] 69%|██████▉   | 300/435 [02:11<00:59,  2.26it/s] 69%|██████▉   | 301/435 [02:12<00:59,  2.26it/s] 69%|██████▉   | 302/435 [02:12<00:58,  2.26it/s] 70%|██████▉   | 303/435 [02:13<00:58,  2.26it/s] 70%|██████▉   | 304/435 [02:13<00:57,  2.26it/s] 70%|███████   | 305/435 [02:13<00:57,  2.26it/s] 70%|███████   | 306/435 [02:14<00:56,  2.26it/s] 71%|███████   | 307/435 [02:14<00:56,  2.26it/s] 71%|███████   | 308/435 [02:15<00:56,  2.26it/s] 71%|███████   | 309/435 [02:15<00:55,  2.26it/s] 71%|███████▏  | 310/435 [02:16<00:55,  2.26it/s] 71%|███████▏  | 311/435 [02:16<00:54,  2.26it/s] 72%|███████▏  | 312/435 [02:16<00:54,  2.26it/s] 72%|███████▏  | 313/435 [02:17<00:53,  2.26it/s] 72%|███████▏  | 314/435 [02:17<00:53,  2.26it/s] 72%|███████▏  | 315/435 [02:18<00:52,  2.27it/s] 73%|███████▎  | 316/435 [02:18<00:52,  2.26it/s] 73%|███████▎  | 317/435 [02:19<00:52,  2.27it/s] 73%|███████▎  | 318/435 [02:19<00:51,  2.26it/s] 73%|███████▎  | 319/435 [02:20<00:51,  2.26it/s] 74%|███████▎  | 320/435 [02:20<00:50,  2.27it/s] 74%|███████▍  | 321/435 [02:20<00:50,  2.27it/s] 74%|███████▍  | 322/435 [02:21<00:49,  2.26it/s] 74%|███████▍  | 323/435 [02:21<00:49,  2.26it/s] 74%|███████▍  | 324/435 [02:22<00:49,  2.26it/s] 75%|███████▍  | 325/435 [02:22<00:48,  2.26it/s] 75%|███████▍  | 326/435 [02:23<00:48,  2.26it/s] 75%|███████▌  | 327/435 [02:23<00:47,  2.26it/s] 75%|███████▌  | 328/435 [02:24<00:47,  2.26it/s] 76%|███████▌  | 329/435 [02:24<00:46,  2.26it/s] 76%|███████▌  | 330/435 [02:24<00:46,  2.26it/s] 76%|███████▌  | 331/435 [02:25<00:45,  2.26it/s] 76%|███████▋  | 332/435 [02:25<00:45,  2.26it/s] 77%|███████▋  | 333/435 [02:26<00:45,  2.26it/s] 77%|███████▋  | 334/435 [02:26<00:44,  2.26it/s] 77%|███████▋  | 335/435 [02:27<00:44,  2.26it/s] 77%|███████▋  | 336/435 [02:27<00:43,  2.26it/s] 77%|███████▋  | 337/435 [02:28<00:43,  2.26it/s] 78%|███████▊  | 338/435 [02:28<00:42,  2.26it/s] 78%|███████▊  | 339/435 [02:28<00:42,  2.26it/s] 78%|███████▊  | 340/435 [02:29<00:41,  2.26it/s] 78%|███████▊  | 341/435 [02:29<00:41,  2.26it/s] 79%|███████▊  | 342/435 [02:30<00:41,  2.26it/s] 79%|███████▉  | 343/435 [02:30<00:40,  2.26it/s] 79%|███████▉  | 344/435 [02:31<00:40,  2.26it/s] 79%|███████▉  | 345/435 [02:31<00:39,  2.26it/s] 80%|███████▉  | 346/435 [02:32<00:39,  2.26it/s] 80%|███████▉  | 347/435 [02:32<00:38,  2.26it/s] 80%|████████  | 348/435 [02:32<00:38,  2.27it/s] 80%|████████  | 349/435 [02:33<00:37,  2.26it/s] 80%|████████  | 350/435 [02:33<00:37,  2.26it/s] 81%|████████  | 351/435 [02:34<00:37,  2.26it/s] 81%|████████  | 352/435 [02:34<00:36,  2.26it/s] 81%|████████  | 353/435 [02:35<00:36,  2.26it/s] 81%|████████▏ | 354/435 [02:35<00:35,  2.26it/s] 82%|████████▏ | 355/435 [02:35<00:35,  2.26it/s] 82%|████████▏ | 356/435 [02:36<00:34,  2.26it/s] 82%|████████▏ | 357/435 [02:36<00:34,  2.26it/s] 82%|████████▏ | 358/435 [02:37<00:34,  2.26it/s] 83%|████████▎ | 359/435 [02:37<00:33,  2.26it/s] 83%|████████▎ | 360/435 [02:38<00:33,  2.26it/s] 83%|████████▎ | 361/435 [02:38<00:32,  2.26it/s] 83%|████████▎ | 362/435 [02:39<00:32,  2.26it/s] 83%|████████▎ | 363/435 [02:39<00:31,  2.26it/s] 84%|████████▎ | 364/435 [02:39<00:31,  2.26it/s] 84%|████████▍ | 365/435 [02:40<00:30,  2.27it/s] 84%|████████▍ | 366/435 [02:40<00:30,  2.26it/s] 84%|████████▍ | 367/435 [02:41<00:30,  2.26it/s] 85%|████████▍ | 368/435 [02:41<00:29,  2.26it/s] 85%|████████▍ | 369/435 [02:42<00:29,  2.26it/s] 85%|████████▌ | 370/435 [02:42<00:28,  2.26it/s] 85%|████████▌ | 371/435 [02:43<00:28,  2.26it/s] 86%|████████▌ | 372/435 [02:43<00:27,  2.26it/s] 86%|████████▌ | 373/435 [02:43<00:27,  2.26it/s] 86%|████████▌ | 374/435 [02:44<00:26,  2.26it/s] 86%|████████▌ | 375/435 [02:44<00:26,  2.26it/s] 86%|████████▋ | 376/435 [02:45<00:26,  2.26it/s] 87%|████████▋ | 377/435 [02:45<00:25,  2.26it/s] 87%|████████▋ | 378/435 [02:46<00:25,  2.26it/s] 87%|████████▋ | 379/435 [02:46<00:24,  2.26it/s] 87%|████████▋ | 380/435 [02:47<00:24,  2.26it/s] 88%|████████▊ | 381/435 [02:47<00:23,  2.26it/s] 88%|████████▊ | 382/435 [02:47<00:23,  2.26it/s] 88%|████████▊ | 383/435 [02:48<00:22,  2.26it/s] 88%|████████▊ | 384/435 [02:48<00:22,  2.26it/s] 89%|████████▊ | 385/435 [02:49<00:22,  2.26it/s] 89%|████████▊ | 386/435 [02:49<00:21,  2.26it/s] 89%|████████▉ | 387/435 [02:50<00:21,  2.26it/s] 89%|████████▉ | 388/435 [02:50<00:20,  2.26it/s] 89%|████████▉ | 389/435 [02:51<00:20,  2.26it/s] 90%|████████▉ | 390/435 [02:51<00:19,  2.26it/s] 90%|████████▉ | 391/435 [02:51<00:19,  2.26it/s] 90%|█████████ | 392/435 [02:52<00:18,  2.26it/s] 90%|█████████ | 393/435 [02:52<00:18,  2.27it/s] 91%|█████████ | 394/435 [02:53<00:18,  2.26it/s] 91%|█████████ | 395/435 [02:53<00:17,  2.26it/s] 91%|█████████ | 396/435 [02:54<00:17,  2.26it/s] 91%|█████████▏| 397/435 [02:54<00:16,  2.26it/s] 91%|█████████▏| 398/435 [02:54<00:16,  2.26it/s] 92%|█████████▏| 399/435 [02:55<00:15,  2.26it/s] 92%|█████████▏| 400/435 [02:55<00:15,  2.26it/s] 92%|█████████▏| 401/435 [02:56<00:15,  2.27it/s] 92%|█████████▏| 402/435 [02:56<00:14,  2.26it/s] 93%|█████████▎| 403/435 [02:57<00:14,  2.26it/s] 93%|█████████▎| 404/435 [02:57<00:13,  2.26it/s] 93%|█████████▎| 405/435 [02:58<00:13,  2.26it/s] 93%|█████████▎| 406/435 [02:58<00:12,  2.26it/s] 94%|█████████▎| 407/435 [02:58<00:12,  2.26it/s] 94%|█████████▍| 408/435 [02:59<00:11,  2.26it/s] 94%|█████████▍| 409/435 [02:59<00:11,  2.26it/s] 94%|█████████▍| 410/435 [03:00<00:11,  2.26it/s] 94%|█████████▍| 411/435 [03:00<00:10,  2.26it/s] 95%|█████████▍| 412/435 [03:01<00:10,  2.26it/s] 95%|█████████▍| 413/435 [03:01<00:09,  2.26it/s] 95%|█████████▌| 414/435 [03:02<00:09,  2.26it/s] 95%|█████████▌| 415/435 [03:02<00:08,  2.27it/s] 96%|█████████▌| 416/435 [03:02<00:08,  2.26it/s] 96%|█████████▌| 417/435 [03:03<00:07,  2.26it/s] 96%|█████████▌| 418/435 [03:03<00:07,  2.26it/s] 96%|█████████▋| 419/435 [03:04<00:07,  2.26it/s] 97%|█████████▋| 420/435 [03:04<00:06,  2.26it/s] 97%|█████████▋| 421/435 [03:05<00:06,  2.26it/s] 97%|█████████▋| 422/435 [03:05<00:05,  2.26it/s] 97%|█████████▋| 423/435 [03:06<00:05,  2.26it/s] 97%|█████████▋| 424/435 [03:06<00:04,  2.26it/s] 98%|█████████▊| 425/435 [03:06<00:04,  2.26it/s] 98%|█████████▊| 426/435 [03:07<00:03,  2.26it/s] 98%|█████████▊| 427/435 [03:07<00:03,  2.26it/s] 98%|█████████▊| 428/435 [03:08<00:03,  2.26it/s] 99%|█████████▊| 429/435 [03:08<00:02,  2.26it/s] 99%|█████████▉| 430/435 [03:09<00:02,  2.26it/s] 99%|█████████▉| 431/435 [03:09<00:01,  2.26it/s] 99%|█████████▉| 432/435 [03:10<00:01,  2.26it/s]100%|█████████▉| 433/435 [03:10<00:00,  2.26it/s]100%|█████████▉| 434/435 [03:10<00:00,  2.26it/s]100%|██████████| 435/435 [03:11<00:00,  2.16it/s]100%|██████████| 435/435 [03:11<00:00,  2.27it/s]
  0%|          | 0/3477 [00:00<?, ?it/s]Traceback (most recent call last):
  File "/n/home11/lilliansun/cs2281_synthetic_data/finetuning_summarization_no_eval.py", line 168, in <module>
    main(model_name, output_dir, scratch_dir, summarization_train_filepath, unique_save_name, dataset_prop, summarization_val_filepath, summarization_test_filepath, batch_size, eval_steps)
  File "/n/home11/lilliansun/cs2281_synthetic_data/finetuning_summarization_no_eval.py", line 132, in main
    summarization_trainer.train()
  File "/n/home11/lilliansun/.conda/envs/jupyter_py3.11/lib/python3.11/site-packages/transformers/trainer.py", line 1780, in train
    return inner_training_loop(
           ^^^^^^^^^^^^^^^^^^^^
  File "/n/home11/lilliansun/.conda/envs/jupyter_py3.11/lib/python3.11/site-packages/transformers/trainer.py", line 2118, in _inner_training_loop
    tr_loss_step = self.training_step(model, inputs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/n/home11/lilliansun/.conda/envs/jupyter_py3.11/lib/python3.11/site-packages/transformers/trainer.py", line 3036, in training_step
    loss = self.compute_loss(model, inputs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/n/home11/lilliansun/.conda/envs/jupyter_py3.11/lib/python3.11/site-packages/transformers/trainer.py", line 3059, in compute_loss
    outputs = model(**inputs)
              ^^^^^^^^^^^^^^^
  File "/n/home11/lilliansun/.conda/envs/jupyter_py3.11/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/n/home11/lilliansun/.conda/envs/jupyter_py3.11/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/n/home11/lilliansun/.conda/envs/jupyter_py3.11/lib/python3.11/site-packages/accelerate/hooks.py", line 166, in new_forward
    output = module._old_forward(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/n/home11/lilliansun/.conda/envs/jupyter_py3.11/lib/python3.11/site-packages/transformers/models/t5/modeling_t5.py", line 1711, in forward
    encoder_outputs = self.encoder(
                      ^^^^^^^^^^^^^
  File "/n/home11/lilliansun/.conda/envs/jupyter_py3.11/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/n/home11/lilliansun/.conda/envs/jupyter_py3.11/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/n/home11/lilliansun/.conda/envs/jupyter_py3.11/lib/python3.11/site-packages/transformers/models/t5/modeling_t5.py", line 1115, in forward
    layer_outputs = layer_module(
                    ^^^^^^^^^^^^^
  File "/n/home11/lilliansun/.conda/envs/jupyter_py3.11/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/n/home11/lilliansun/.conda/envs/jupyter_py3.11/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/n/home11/lilliansun/.conda/envs/jupyter_py3.11/lib/python3.11/site-packages/accelerate/hooks.py", line 166, in new_forward
    output = module._old_forward(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/n/home11/lilliansun/.conda/envs/jupyter_py3.11/lib/python3.11/site-packages/transformers/models/t5/modeling_t5.py", line 695, in forward
    self_attention_outputs = self.layer[0](
                             ^^^^^^^^^^^^^^
  File "/n/home11/lilliansun/.conda/envs/jupyter_py3.11/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/n/home11/lilliansun/.conda/envs/jupyter_py3.11/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/n/home11/lilliansun/.conda/envs/jupyter_py3.11/lib/python3.11/site-packages/accelerate/hooks.py", line 166, in new_forward
    output = module._old_forward(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/n/home11/lilliansun/.conda/envs/jupyter_py3.11/lib/python3.11/site-packages/transformers/models/t5/modeling_t5.py", line 602, in forward
    attention_output = self.SelfAttention(
                       ^^^^^^^^^^^^^^^^^^^
  File "/n/home11/lilliansun/.conda/envs/jupyter_py3.11/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/n/home11/lilliansun/.conda/envs/jupyter_py3.11/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/n/home11/lilliansun/.conda/envs/jupyter_py3.11/lib/python3.11/site-packages/accelerate/hooks.py", line 166, in new_forward
    output = module._old_forward(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/n/home11/lilliansun/.conda/envs/jupyter_py3.11/lib/python3.11/site-packages/transformers/models/t5/modeling_t5.py", line 565, in forward
    attn_weights = nn.functional.dropout(
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/n/home11/lilliansun/.conda/envs/jupyter_py3.11/lib/python3.11/site-packages/torch/nn/functional.py", line 1268, in dropout
    return _VF.dropout_(input, p, training) if inplace else _VF.dropout(input, p, training)
                                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.22 GiB. GPU 1 has a total capacity of 79.22 GiB of which 1.82 GiB is free. Including non-PyTorch memory, this process has 77.38 GiB memory in use. Of the allocated memory 76.33 GiB is allocated by PyTorch, and 394.53 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
  0%|          | 0/3477 [00:02<?, ?it/s]
